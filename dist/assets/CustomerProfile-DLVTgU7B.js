import{r as l,C as Q,o as M,aG as je,p as ye,q as Ne,v as ve,F as Y,ax as Ie,aH as Z,z as we,I as U,u as K,aI as Ce,E as Oe,n as t,S as Se,B as ee,aJ as Ae}from"./index-BZdp03kJ.js";import{p as oe,v as D}from"./index-BOtiA3SE.js";import{T as Pe,a as F}from"./index-XQVyLKnQ.js";import{R as $e,E as P}from"./index-JlIRVu-V.js";import{C as Ee}from"./index-D0m3IjQR.js";import{D as i}from"./index-qXtYSikz.js";import{T as le}from"./index-DFXBIh22.js";import{C as X}from"./Collapse-BNHkdXUf.js";import{F as te}from"./Table-D2ZlPbwe.js";import{R as De}from"./FallOutlined-D0-Psr6N.js";import{L as $}from"./index-FvSTCZoG.js";import{R as Re}from"./DollarOutlined-9gkKQefK.js";import"./EditOutlined-DN9479r6.js";import"./index-CtnzGPGj.js";const T=({children:e})=>{const{getPrefixCls:n}=l.useContext(Q),r=n("breadcrumb");return l.createElement("li",{className:`${r}-separator`,"aria-hidden":"true"},e===""?e:e||"/")};T.__ANT_BREADCRUMB_SEPARATOR=!0;var Be=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};function Le(e,n){if(e.title===void 0||e.title===null)return null;const r=Object.keys(n).join("|");return typeof e.title=="object"?e.title:String(e.title).replace(new RegExp(`:(${r})`,"g"),(s,o)=>n[o]||s)}function ie(e,n,r,s){if(r==null)return null;const{className:o,onClick:m}=n,u=Be(n,["className","onClick"]),x=Object.assign(Object.assign({},oe(u,{data:!0,aria:!0})),{onClick:m});return s!==void 0?l.createElement("a",Object.assign({},x,{className:M(`${e}-link`,o),href:s}),r):l.createElement("span",Object.assign({},x,{className:M(`${e}-link`,o)}),r)}function Te(e,n){return(s,o,m,u,x)=>{if(n)return n(s,o,m,u);const g=Le(s,o);return ie(e,s,g,x)}}var V=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};const ce=e=>{const{prefixCls:n,separator:r="/",children:s,menu:o,overlay:m,dropdownProps:u,href:x}=e,v=(I=>{if(o||m){const w=Object.assign({},u);if(o){const y=o||{},{items:C}=y,f=V(y,["items"]);w.menu=Object.assign(Object.assign({},f),{items:C==null?void 0:C.map((b,p)=>{var{key:h,title:a,label:d,path:c}=b,j=V(b,["key","title","label","path"]);let O=d??a;return c&&(O=l.createElement("a",{href:`${x}${c}`},O)),Object.assign(Object.assign({},j),{key:h??p,label:O})})})}else m&&(w.overlay=m);return l.createElement(je,Object.assign({placement:"bottom"},w),l.createElement("span",{className:`${n}-overlay-link`},I,l.createElement($e,null)))}return I})(s);return v!=null?l.createElement(l.Fragment,null,l.createElement("li",null,v),r&&l.createElement(T,null,r)):null},de=e=>{const{prefixCls:n,children:r,href:s}=e,o=V(e,["prefixCls","children","href"]),{getPrefixCls:m}=l.useContext(Q),u=m("breadcrumb",n);return l.createElement(ce,Object.assign({},o,{prefixCls:u}),ie(u,o,r,s))};de.__ANT_BREADCRUMB_ITEM=!0;const ze=e=>{const{componentCls:n,iconCls:r,calc:s}=e;return{[n]:Object.assign(Object.assign({},ve(e)),{color:e.itemColor,fontSize:e.fontSize,[r]:{fontSize:e.iconFontSize},ol:{display:"flex",flexWrap:"wrap",margin:0,padding:0,listStyle:"none"},a:Object.assign({color:e.linkColor,transition:`color ${e.motionDurationMid}`,padding:`0 ${Y(e.paddingXXS)}`,borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",marginInline:s(e.marginXXS).mul(-1).equal(),"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover}},Ie(e)),"li:last-child":{color:e.lastItemColor},[`${n}-separator`]:{marginInline:e.separatorMargin,color:e.separatorColor},[`${n}-link`]:{[`
          > ${r} + span,
          > ${r} + a
        `]:{marginInlineStart:e.marginXXS}},[`${n}-overlay-link`]:{borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",padding:`0 ${Y(e.paddingXXS)}`,marginInline:s(e.marginXXS).mul(-1).equal(),[`> ${r}`]:{marginInlineStart:e.marginXXS,fontSize:e.fontSizeIcon},"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover,a:{color:e.linkHoverColor}},a:{"&:hover":{backgroundColor:"transparent"}}},[`&${e.componentCls}-rtl`]:{direction:"rtl"}})}},_e=e=>({itemColor:e.colorTextDescription,lastItemColor:e.colorText,iconFontSize:e.fontSize,linkColor:e.colorTextDescription,linkHoverColor:e.colorText,separatorColor:e.colorTextDescription,separatorMargin:e.marginXS}),ke=ye("Breadcrumb",e=>{const n=Ne(e,{});return ze(n)},_e);var re=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};function He(e){const{breadcrumbName:n,children:r}=e,s=re(e,["breadcrumbName","children"]),o=Object.assign({title:n},s);return r&&(o.menu={items:r.map(m=>{var{breadcrumbName:u}=m,x=re(m,["breadcrumbName"]);return Object.assign(Object.assign({},x),{title:u})})}),o}function Fe(e,n){return l.useMemo(()=>e||(n?n.map(He):null),[e,n])}var Me=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};const Xe=(e,n)=>{if(n===void 0)return n;let r=(n||"").replace(/^\//,"");return Object.keys(e).forEach(s=>{r=r.replace(`:${s}`,e[s])}),r},G=e=>{const{prefixCls:n,separator:r="/",style:s,className:o,rootClassName:m,routes:u,items:x,children:g,itemRender:v,params:I={}}=e,w=Me(e,["prefixCls","separator","style","className","rootClassName","routes","items","children","itemRender","params"]),{getPrefixCls:y,direction:C,breadcrumb:f}=l.useContext(Q);let b;const p=y("breadcrumb",n),[h,a,d]=ke(p),c=Fe(x,u),j=Te(p,v);if(c&&c.length>0){const A=[],E=x||u;b=c.map((S,L)=>{const{path:ue,key:z,type:pe,menu:J,overlay:W,onClick:xe,className:fe,separator:he,dropdownProps:ge}=S,_=Xe(I,ue);_!==void 0&&A.push(_);const q=z??L;if(pe==="separator")return l.createElement(T,{key:q},he);const k={},be=L===c.length-1;J?k.menu=J:W&&(k.overlay=W);let{href:H}=S;return A.length&&_!==void 0&&(H=`#/${A.join("/")}`),l.createElement(ce,Object.assign({key:q},k,oe(S,{data:!0,aria:!0}),{className:fe,dropdownProps:ge,href:H,separator:be?"":r,onClick:xe,prefixCls:p}),j(S,I,E,A,H))})}else if(g){const A=Z(g).length;b=Z(g).map((E,S)=>{if(!E)return E;const L=S===A-1;return we(E,{separator:L?"":r,key:S})})}const O=M(p,f==null?void 0:f.className,{[`${p}-rtl`]:C==="rtl"},o,m,a,d),me=Object.assign(Object.assign({},f==null?void 0:f.style),s);return h(l.createElement("nav",Object.assign({className:O,style:me},w),l.createElement("ol",null,b)))};G.Item=de;G.Separator=T;var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},Qe=function(n,r){return l.createElement(U,K({},n,{ref:r,icon:Ve}))},se=l.forwardRef(Qe),Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},Ke=function(n,r){return l.createElement(U,K({},n,{ref:r,icon:Ue}))},ae=l.forwardRef(Ke),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Je=function(n,r){return l.createElement(U,K({},n,{ref:r,icon:Ge}))},We=l.forwardRef(Je);const{TabPane:R}=le,{Title:B,Text:N}=Pe,{Panel:ne}=X,mt=()=>{const{id:e}=Ce(),n=Oe(),[r,s]=l.useState(null),[o,m]=l.useState(!0),[u,x]=l.useState([]),[g,v]=l.useState([]),[I,w]=l.useState([]),[y,C]=l.useState([]);if(l.useEffect(()=>{m(!0),Promise.all([D.get(`/api/accounts/${e}`),D.get(`/api/quotations/business/${e}`),D.get(`/api/invoices/business/${e}`),D.get(`/api/accounts/${e}/followups`),D.get(`/api/invoices/business/${e}/payments`)]).then(([a,d,c,j,O])=>{s(a.data),x(d.data||[]),v(c.data||[]),w(j.data||[]),C(O.data||[])}).catch(a=>{console.error("Failed to load data:",a)}).finally(()=>m(!1))},[e]),o)return t.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-50",children:t.jsx(Se,{size:"large",tip:"Loading Customer Profile..."})});if(!r)return t.jsxs("div",{className:"p-6 bg-white shadow-lg rounded-lg m-6",children:[t.jsx(ee,{className:"mb-4",icon:t.jsx(se,{}),onClick:()=>n("/customers"),children:"Back to Customers"}),t.jsx(B,{level:3,className:"mt-4 text-center text-gray-700",children:"Customer Not Found"}),t.jsx(P,{description:"No data found for this customer ID. It might not exist or there was an issue fetching it.",className:"mt-8"})]});const f=[...I].sort((a,d)=>new Date(d.followupDate||d.date)-new Date(a.followupDate||a.date)),b=[...r.notes||[]].sort((a,d)=>new Date(d.timestamp)-new Date(a.timestamp)),p=a=>`₹${Number(a||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,h=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch(d){return console.error("Error formatting date:",a,d),a}};return t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsx(G,{className:"mb-4",items:[{title:"Customers",href:"/customers"},{title:r.businessName||"Profile"}]}),t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx(ee,{className:"bg-blue-500 hover:bg-blue-600 text-white rounded-md shadow-md",icon:t.jsx(se,{}),onClick:()=>n(-1),children:"Back"}),t.jsxs(B,{level:2,className:"text-gray-800 font-semibold mb-0",children:[r.businessName," Profile"]})]}),t.jsx(Ee,{title:t.jsx(B,{level:4,className:"text-gray-700 mb-0",children:"Customer Details"}),className:"shadow-lg rounded-lg mb-6 border-t-4 border-blue-500",children:t.jsxs(i,{bordered:!0,column:{xs:1,sm:2,md:2,lg:3},size:"middle",className:"text-gray-700",children:[t.jsx(i.Item,{label:"Business Name",children:t.jsx(N,{strong:!0,children:r.businessName||"N/A"})}),t.jsx(i.Item,{label:"GSTIN",children:r.gstNumber||"N/A"}),t.jsx(i.Item,{label:"Customer Name",children:r.contactName||"N/A"}),t.jsx(i.Item,{label:"Email",children:r.email||"N/A"}),t.jsx(i.Item,{label:"Phone Number",children:r.phoneNumber||"N/A"}),t.jsx(i.Item,{label:"Status",children:t.jsx(F,{color:r.status==="Active"?"green":"red",children:r.status||"N/A"})}),t.jsx(i.Item,{label:"Type",children:r.type||"N/A"}),t.jsx(i.Item,{label:"Customer Address",span:3,children:Array.isArray(r.addressLines)&&r.addressLines.length>0?r.addressLines.join(", "):"N/A"}),t.jsx(i.Item,{label:"Created At",children:r.createdAt?new Date(r.createdAt).toLocaleString():"N/A"}),t.jsx(i.Item,{label:"Last Updated",children:r.updatedAt?new Date(r.updatedAt).toLocaleString():"N/A"})]})}),t.jsxs(le,{defaultActiveKey:"1",className:"bg-white p-4 rounded-lg shadow-lg",children:[t.jsx(R,{tab:t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(De,{}),t.jsxs("span",{children:["Quotations (",u.length,")"]})]}),children:u.length===0?t.jsx(P,{description:"No quotations found for this customer.",className:"py-8"}):t.jsx(X,{accordion:!0,className:"shadow-sm",children:u.map((a,d)=>t.jsxs(ne,{header:t.jsxs("div",{className:"font-semibold text-lg flex justify-between items-center",children:[t.jsxs("span",{children:["Quotation #",a.quotationNumber]}),t.jsx("span",{className:"text-green-600",children:p(a.totalAmount)})]}),className:"bg-gray-50 border-b border-gray-200",children:[t.jsxs(i,{bordered:!0,column:2,size:"small",className:"mb-4",children:[t.jsx(i.Item,{label:"Date",children:h(a.date)}),t.jsx(i.Item,{label:"Status",children:t.jsx(F,{color:a.status==="Approved"?"green":"orange",children:a.status||"N/A"})}),t.jsx(i.Item,{label:"Customer Name",children:a.contactName||"N/A"}),t.jsx(i.Item,{label:"GSTIN",children:a.gstNumber||"N/A"}),t.jsx(i.Item,{label:"Customer Address",span:2,children:Array.isArray(a.customerAddress)&&a.customerAddress.length>0?a.customerAddress.join(", "):"N/A"})]}),t.jsx(B,{level:5,className:"mt-4 mb-2 text-gray-700",children:"Items Quoted"}),t.jsx(te,{dataSource:a.items||[],columns:[{title:"Description",dataIndex:"description",key:"description"},{title:"HSN/SAC",dataIndex:"hsn",key:"hsn"},{title:"Qty",dataIndex:"quantity",key:"quantity"},{title:"Rate (₹)",dataIndex:"rate",key:"rate",render:c=>p(c)},{title:"Amount (₹)",dataIndex:"amount",key:"amount",render:c=>p(c)}],pagination:!1,rowKey:(c,j)=>j,size:"small",className:"border rounded-md"})]},a._id||d))})},"1"),t.jsx(R,{tab:t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(Ae,{}),t.jsxs("span",{children:["Invoices (",g.length,")"]})]}),children:g.length===0?t.jsx(P,{description:"No invoices found for this customer.",className:"py-8"}):t.jsx(X,{accordion:!0,className:"shadow-sm",children:g.map((a,d)=>t.jsxs(ne,{header:t.jsxs("div",{className:"font-semibold text-lg flex justify-between items-center",children:[t.jsxs("span",{children:["Invoice #",a.invoiceNumber]}),t.jsx("span",{className:"text-green-600",children:p(a.totalAmount)})]}),className:"bg-gray-50 border-b border-gray-200",children:[t.jsxs(i,{bordered:!0,size:"small",column:2,className:"mb-4",children:[t.jsx(i.Item,{label:"Date",children:h(a.date)}),t.jsx(i.Item,{label:"Due Date",children:h(a.dueDate)}),t.jsx(i.Item,{label:"Status",children:t.jsx(F,{color:a.status==="Paid"?"green":a.status==="Pending"?"orange":"red",children:a.status||"N/A"})}),t.jsx(i.Item,{label:"Customer Name",children:a.contactName||"N/A"}),t.jsx(i.Item,{label:"GSTIN",children:a.gstNumber||"N/A"}),t.jsx(i.Item,{label:"Customer Address",span:2,children:Array.isArray(a.customerAddress)&&a.customerAddress.length>0?a.customerAddress.join(", "):"N/A"})]}),t.jsx(B,{level:5,className:"mt-4 mb-2 text-gray-700",children:"Items Invoiced"}),t.jsx(te,{dataSource:a.items||[],columns:[{title:"Description",dataIndex:"description",key:"description"},{title:"HSN/SAC",dataIndex:"hsn",key:"hsn"},{title:"Qty",dataIndex:"quantity",key:"quantity"},{title:"Rate (₹)",dataIndex:"rate",key:"rate",render:c=>p(c)},{title:"Amount (₹)",dataIndex:"amount",key:"amount",render:c=>p(c)}],pagination:!1,rowKey:(c,j)=>j,size:"small",className:"border rounded-md"})]},a._id||d))})},"2"),t.jsx(R,{tab:t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(We,{}),t.jsxs("span",{children:["Follow-ups (",f.length,")"]})]}),children:f.length===0?t.jsx(P,{description:"No follow-ups found for this customer.",className:"py-8"}):t.jsx($,{bordered:!0,dataSource:f,className:"rounded-lg overflow-hidden",renderItem:a=>t.jsx($.Item,{className:"flex flex-col items-start bg-white p-4 hover:bg-gray-50 transition-colors duration-200",children:t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"font-semibold text-gray-700 text-base mb-1",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:t.jsx(ae,{})}),t.jsx(N,{strong:!0,children:"Date:"})," ",h(a.followupDate||a.date)]}),t.jsxs("div",{className:"text-gray-800 mb-1 leading-relaxed",children:[t.jsx(N,{strong:!0,children:"Note:"})," ",a.note||a.comment||"No comment provided"]}),a.addedBy&&t.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["Added by: ",t.jsx(N,{italic:!0,children:a.addedBy.name||a.addedBy.email||"Unknown"})]})]})})})},"3"),t.jsx(R,{tab:t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(Re,{}),t.jsxs("span",{children:["Payments (",y.length,")"]})]}),children:y.length===0?t.jsx(P,{description:"No payments found for this customer.",className:"py-8"}):t.jsx($,{bordered:!0,dataSource:y,className:"rounded-lg overflow-hidden",renderItem:a=>t.jsxs($.Item,{className:"flex items-center justify-between bg-white p-4 hover:bg-gray-50 transition-colors duration-200",children:[t.jsxs("div",{className:"flex-grow",children:[t.jsx(N,{strong:!0,className:"text-green-600 text-lg",children:p(a.amount)}),t.jsxs(N,{className:"ml-2 text-gray-700",children:["via ",a.method||"N/A"]})]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[h(a.date)," by ",a.addedBy||"Unknown"]})]})})},"4"),t.jsx(R,{tab:t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(ae,{}),t.jsxs("span",{children:["Notes (",b.length,")"]})]}),children:b.length===0?t.jsx(P,{description:"No notes available for this customer.",className:"py-8"}):t.jsx($,{bordered:!0,dataSource:b,className:"rounded-lg overflow-hidden",renderItem:a=>{var d,c;return t.jsx($.Item,{className:"flex flex-col items-start bg-white p-4 hover:bg-gray-50 transition-colors duration-200",children:t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"text-gray-800 text-base leading-relaxed mb-1",children:[t.jsx(N,{strong:!0,children:"Note:"})," ",a.text||"No text provided"]}),t.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["Added by: ",t.jsx(N,{italic:!0,children:a.author||((d=a.addedBy)==null?void 0:d.name)||((c=a.addedBy)==null?void 0:c.email)||"Unknown"})," | ",a.timestamp?new Date(a.timestamp).toLocaleString():"N/A"]})]})})}})},"5")]})]})};export{mt as default};
